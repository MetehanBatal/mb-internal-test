<!DOCTYPE html>
<html lang="en">

<head>
	<meta name="robots" content="noindex">
	<script> TripleHeadless = 'aloft-home.myshopify.com' </script>
	<!-- TriplePixel :: start -->
	<script>
		~function(W,H,A,L,E,_){function O(T,R){void 0===R&&(R=!1),H=new XMLHttpRequest,H.open("GET","//triplewhale-pixel.web.app/triplepx.txt?"+~(Date.now()/9e7),!0),H.send(null),H.onreadystatechange=function(){4===H.readyState&&200===H.status?setTimeout(function(){return eval(H.responseText)},50):(299<H.status||H.status<200)&&T&&!R&&(R=!0,O(T-1))}}if(L=window,!L[H+"sn"]){L[H+"sn"]=1;try{A.setItem(H,1+(0|A.getItem(H)||0)),W.includes("⇈")&&A.setItem(H+"Stg",1+(0|A.getItem(H+"Stg")||0)),(E=JSON.parse(A.getItem(H+"U")||"[]")).push(location.href),A.setItem(H+"U",JSON.stringify(E))}catch(e){}A.getItem('"!nC`')||(A=L,A[H]||(L=function(){return Date.now().toString(36)+"_"+Math.random().toString(36)},E=A[H]=function(t,e){return W=L(),(E._q=E._q||[]).push([W,t,e]),E._headless=!0,W},E.ch=W,O(5)))}}("","TriplePixel",localStorage);
	</script>
	<!-- TriplePixel :: end -->
	<script>
		var head = document.head;
		var script = document.createElement('script');
		script.type = 'text/javascript';
		script.src = "https://t.miraclebrand.co/v1/lst/universal-script?ph=f635c7a6a1fa8bdf05277a5a7599afc05bc3b585d3f7260daf42c511450d0801&tag=!clicked";
		head.appendChild(script);
	</script>

	<meta charset="utf-8">
	<title>Special Offer | Miracle</title>
	
	<meta content="Special Offer | Miracle" property="og:title">

 



	<link href="css/upsell_branded.css" rel="stylesheet" type="text/css">
	<!-- <link href="css/popup.css" rel="stylesheet" type="text/css"> -->
	
	<link href="../images/favicon.png" rel="shortcut icon" type="image/x-icon">
	<link href="../images/webclip.png" rel="apple-touch-icon">
	
	<script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
	
	<!-- SYSTEM CODE -->
	<script type="text/javascript" src="https://cdn.shopmiraclebrand.co/js/cart_loader.js"></script>
	<script type="text/javascript" async src="https://try.miraclebrand.co/pixel.js"></script>
	
	<meta content="api.shopmiraclebrand.co" name="checkout-api-endpoint">
	<meta content="width=device-width, initial-scale=1.0" name="viewport">
	
	<meta content="mb-sheets-up-v5-1b-v2" name="checkout-upsell-page-name">
	<meta content="mb-sheets-up-v5-1b-v2" name="checkout-funnel-name">
	<meta content="sheets" name="checkout-aux-page-name">

	<!-- Begin: Northbeam Pixel -->
	<script async type="text/javascript" src="//j.northbeam.io/ota-sp/d6b41dbb-ce9e-4e1e-bdc2-36492a0d7ac1.js"></script>
	<!-- End: Northbeam Pixel -->

	<script data-obct type = "text/javascript">
		/** DO NOT MODIFY THIS CODE**/
		!function(_window, _document) {
		  var OB_ADV_ID = '00a258b2cec8acaaadf2affcd209c38fb4';
		  if (_window.obApi) {
			var toArray = function(object) {
			  return Object.prototype.toString.call(object) === '[object Array]' ? object : [object];
			};
			_window.obApi.marketerId = toArray(_window.obApi.marketerId).concat(toArray(OB_ADV_ID));
			return;
		  }
		  var api = _window.obApi = function() {
			api.dispatch ? api.dispatch.apply(api, arguments) : api.queue.push(arguments);
		  };
		  api.version = '1.1';
		  api.loaded = true;
		  api.marketerId = OB_ADV_ID;
		  api.queue = [];
		  var tag = _document.createElement('script');
		  tag.async = true;
		  tag.src = '//amplify.outbrain.com/cp/obtp.js';
		  tag.type = 'text/javascript';
		  var script = _document.getElementsByTagName('script')[0];
		  script.parentNode.insertBefore(tag, script);
		}(window, document);
	  
		obApi('track', 'PAGE_VIEW');
	</script>

	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/8.3.0/swiper-bundle.css" integrity="sha512-W3EpFysZWfMjkA5NIsJ1jQbd2CvZrEY0YRB16wlQdePUuxykf4E47/Yqajz2vkCRcMYkxY9+CHY6r2Al0AExBQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />

	<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script>

	<!-- Page variables to
		 conditionally trigger the functions on ./js/upsell_n.js -->
	<script>
		const hasSlider = true;
		const hasSelector = false;
		const hasToggleButtons = false;
		const hasFabricSelection = false;
		const hasSizeSelection = false;
		const hasColorSelection = false;

		const hasDynamicColorChange = true;

		const pagePath = "1b";
	</script>
</head>

<body class="up-1b">
 


	<!-- <div class="popup-outer-box">
		<div class="popup-overlay popup-closer"></div>

		<div class="modal">
			<img src="./images/icons/close.svg" alt="" class="close-icon popup-closer">

			<img src="./images/popup/02.jpg" alt="" />

			<div class="modal-description">
				<div class="modal-header">
					<h3 class="modal-title sm">
						Become a Miracle Made Member and save
						<span class="modal-title-discount">10% on todays purchase and hundreds of other items</span>
					</h3>
				</div>
				<div class="modal-checks">
					<ul class="modal-check-list">
						<li>
							<div class="icon-holder">
								<img src="./images/icons/tick.svg" alt="Upsell - Miracle Made">
							</div>
							<p>Get 10% back on today’s purchase</p>
						</li>
						<li>
							<div class="icon-holder">
								<img src="./images/icons/tick.svg" alt="Upsell - Miracle Made">
							</div>
							<p>Save up to 25% off hundreds of items</p>
						</li>
						<li>
							<div class="icon-holder">
								<img src="./images/icons/tick.svg" alt="Upsell - Miracle Made">
							</div>
							<p>Get 10% miracle credit on future purchases</p>
						</li>
						<li>
							<div class="icon-holder">
								<img src="./images/icons/tick.svg" alt="Upsell - Miracle Made">
							</div>
							<p>VIP access to new items and limited-edition colors</p>
						</li>
						<li>
							<div class="icon-holder">
								<img src="./images/icons/tick.svg" alt="Upsell - Miracle Made">
							</div>
							<p>FREE Gifts</p>
						</li>
					</ul>
				</div>
			</div>
			<div class="modal-trial">
				<button class="popup-button popup-closer">Start my 14-day FREE trial</button>
				<p class="modal-trial-description">
					Free for 14 days and then just $99 per year or $8.25 per month
				</p>
			</div>
		</div>
	</div> -->

	<div class="progress-bar-box">
		<div class="progress-bar" data-step="1"></div>
	</div>

	<main>
		<div class="container">
			<!-- START - Confirmation Box -->
			<div class="confirmation-box hidden">
				<img src="./images/icons/tick.svg" alt="Confirmed Icon">

				<div class="confirmation-text-holder">
					<h4>CONFIRMED! Item has been added to your existing order!</h4>

					<p>Check out our other offer below!</p>
				</div>
			</div>
			<!-- END - Confirmation Box -->

			<!-- START - Navbar -->
			<nav>
				<img src="./images/icons/logo.svg" alt="Miracle Made Logo">

				<div class="step-box">
					<div class="step">
						<div class="step-circle">
							1
						</div>

						<p>Checkout</p>
					</div>

					<div class="step">
						<div class="step-circle">
							2
						</div>

						<p>Special Deal</p>
					</div>

					<div class="step">
						<div class="step-circle">
							3
						</div>

						<p>Summary</p>
					</div>
				</div>
			</nav>
			<!-- END - Navbar -->

			<!-- START - Upgrade Banner -->
			<div class="upgrade-ban">
				<h4>Hold Up! We Really Want You To <br class="desktop-hidden" />Try These Extra Luxe Sheets!</h4>

				<h3>Upgrade your sheets to extra luxe for <span class="color-green">50% OFF!</span></h3>

				<p>
					Everyone deserves to have ultra-luxurious, smooth, and silky feeling sheets, so try them now 100% Risk Free
				</p>
			</div>
			<!-- END - Upgrade Banner -->

			<div class="upsell-box">
				<div class="upsell-slider">
					<div class="swiper swiper-main">
						<div class="swiper-wrapper">
							<div class="swiper-slide">
								<img src="./images/sliders/1b/stone/01.webp" class="lozad slider-img" alt="Upsell Image">
							</div>
							<div class="swiper-slide">
								<img data-src="./images/sliders/1b/stone/02.webp" class="lozad slider-img" alt="Upsell Image">
							</div>
							<div class="swiper-slide">
								<img data-src="./images/sliders/1b/stone/03.webp" class="lozad slider-img" alt="Upsell Image">
							</div>
							<div class="swiper-slide">
								<img data-src="./images/sliders/1b/stone/04.webp" class="lozad slider-img" alt="Upsell Image">
							</div>
							<div class="swiper-slide">
								<img src="./images/sliders/1b/stone/05.webp" class="lozad slider-img" alt="Upsell Image">
							</div>
						</div>

						<div class="slider-pagination-button prev">
							<svg version="1.1" id="navigation-arrow-right_1_" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 8 13" style="enable-background:new 0 0 8 13;" xml:space="preserve">
								<polygon points="0.4,1.7 4.8,6.5 0.4,11.2 1.8,12.7 7.5,6.5 1.8,0.3 " fill="#ffffff"/>
							</svg>
						</div>

						<div class="slider-pagination-button next">
							<svg version="1.1" id="navigation-arrow-right_1_" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 8 13" style="enable-background:new 0 0 8 13;" xml:space="preserve">
								<polygon points="0.4,1.7 4.8,6.5 0.4,11.2 1.8,12.7 7.5,6.5 1.8,0.3 " fill="#ffffff"/>
							</svg>
						</div>
					</div>

					<div class="swiper swiper-thumbnails">
						<div class="swiper-wrapper">
							<div class="swiper-slide">
								<img data-src="./images/sliders/1b/stone/01_thumb.webp" class="lozad thumb-img" alt="Upsell Image">
							</div>
							<div class="swiper-slide">
								<img data-src="./images/sliders/1b/stone/02_thumb.webp" class="lozad thumb-img" alt="Upsell Image">
							</div>
							<div class="swiper-slide">
								<img data-src="./images/sliders/1b/stone/03_thumb.webp" class="lozad thumb-img" alt="Upsell Image">
							</div>
							<div class="swiper-slide">
								<img data-src="./images/sliders/1b/stone/04_thumb.webp" class="lozad thumb-img" alt="Upsell Image">
							</div>
							<div class="swiper-slide">
								<img data-src="./images/sliders/1b/stone/05_thumb.webp" class="lozad thumb-img" alt="Upsell Image">
							</div>
						</div>
					</div>
				</div>

				<div class="upsell-content">
					<div class="trusted-by">
						<img src="./images/icons/stars.svg" alt="5-star Experience - Miracle Made">

						<p>10,078+ FIVE-STAR COMPANY REVIEWS</p>
					</div>

					<div class="callout-box">
						<img src="./images/icons/hourglass.svg" alt="Limited Time Offer - Miracle Made">

						<p><strong class="uppercase">One-time Offer – Only available with this current order.</strong><span> You will never see this again.</span></p>
					</div>

					<p class="upsell-description">
						These are just some of the amazing benefits of our Extra Luxe sheets: You will absolutely come back wishing that you had the Extra Luxe sheets. Now you can take advantage of the Extra Luxe sheets for only <strong>$30 each.</strong>
					</p>

					<ul>
						<li>
							<div class="icon-holder">
								<img src="./images/icons/tick.svg" alt="Upsell - Miracle Made">
							</div>
							<p>Latest Gen 3 of Miracle Clean & Cool™ Fabrics</p>
						</li>
						<li>
							<div class="icon-holder">
								<img src="./images/icons/tick.svg" alt="Upsell - Miracle Made">
							</div>
							<p>Our Most Premium Eucalyptus Blend with Sateen Weave</p>
						</li>
						<li>
							<div class="icon-holder">
								<img src="./images/icons/tick.svg" alt="Upsell - Miracle Made">
							</div>
							<p>Enhanced Breathability</p>
						</li>
					</ul>

					<div class="price-container">
						<div>
							<h4 class="price"><span class="non-usa"></span>$30*</h4>
							<p><strong>Per Upgrade</strong></p>
						</div>

						<div class="deal-endtime">
							*Plus any applicable taxes
							<div class="timer-wrapper">
								<div class="flashing-circle"></div>
								<p>Deal reserved for: <span class="timer" data-timer-duration="900">15:00</span> min</p>
							</div>
						</div>
					</div>

					<a href="./2d.html?upsell=true" class="checkout-accept-upsell button---yes-upsell cta-button" data-upsell-type="swap-variant" data-upsell-param1="39767106650262" data-next-url='./2d.html?upsell=true'>
						Yes, Upgrade My Order with 1-Click-buy!
					</a>

					<a href="./2c.html" class="link decline-link">No, thank you! I don’t want to get this one-time-only offer.</a>

					<hr>

					<div class="money-back-text">
						<img src="./images/icons/30-day-guarantee.svg" alt="30-day money back guarantee - Miracle Made">

						<p>30 day money-back guarantee</p>
					</div>
				</div>
			</div>
		</div>
	</main>

	<footer>
		<p>
			Copyright 2023. Miracle Brand LLC. All rights reserved.
		</p>

		<div>
			<a href="https://www.miraclebrand.co/pages/privacy-policy">Privacy Policy</a>
			<a href="https://www.miraclebrand.co/pages/care-guide">Care Guide</a>
			<a href="https://www.miraclebrand.co/pages/terms-and-conditions">Terms of Service</a>
		</div>
	</footer>

	<script>
		const observer = lozad();
		observer.observe();
	</script>

	<script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/8.3.0/swiper-bundle.min.js" integrity="sha512-+oUge+PHyEv6R7xjWkZ9zeGWbRLIs24P6/2afAClEZi+kZ2vsK+Di4Ud9ON39uAbkkcCrewO3ayzk2765bbPpw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
	<!-- <script src="js/upsell_n.js"></script>-->
	<!-- <script src="js/popup.js"></script> -->

	<script type="text/javascript">
		window.checkoutReadyCallbacks = window.checkoutReadyCallbacks || []; 
		window.checkoutReadyCallbacks.push(() => {
			if (checkoutData.cart.shippingZone !== "US") {
				$(".non-usa").html("USD ");
			}
		});

		let upsellHench = {
			choices: '',

			fabric: 'signature',

			size: 'queen',

			color: 'stone',

			quantity: '1',

			swiper: '',

			thumbsSwiper: '',

			initSwiper: function() {
				const self = this;

				console.log('Swiper init');

				if (hasSlider) {
					self.thumbsSwiper = new Swiper('.swiper-thumbnails', {
						slidesPerView: 5,
						spaceBetween: 8,
						watchSlidesProgress: true
					});

					self.swiper = new Swiper('.swiper-main', {
						loop: true,

						// Navigation arrows
						navigation: {
							nextEl: '.slider-pagination-button.next',
							prevEl: '.slider-pagination-button.prev',
						},

						thumbs: {
							swiper: self.thumbsSwiper,
						}
					});
				}
			},

			initVariantSelection: function() {
				const self = this;

				if (hasSelector) {
					const element = document.querySelector('.variants');
				
					self.choices = new Choices(element, {
						searchEnabled: false,
						itemSelectText: ''
					});

					self.choices.passedElement.element.addEventListener( 'choice', function(event) {
						self.quantity = event.detail.choice.id;

						self.updateVariant();
					}, false );

					self.quantity = 2;

					if (document.querySelector('.is-highlighted')) {
						document.querySelector('.is-highlighted').classList.remove('is-highlighted')	
					}

					self.usdPrefix();
				}
			},


			usdPrefix: function() {
				const self = this;

				window.checkoutReadyCallbacks = window.checkoutReadyCallbacks || [];
				window.checkoutReadyCallbacks.push(() => {
					if (checkoutData.cart.shippingZone !== "US") {
						let currentChoices = this.choices.config.choices;
						console.log(currentChoices);
						let newChoices = [];
						currentChoices.forEach((choice) => {
							let variantData = {
								value: choice.value,
								label: choice.label.replace("$", "USD $"),
							}
							newChoices.push(variantData);
						})
						this.choices.clearStore();
						this.choices.setValue(newChoices);
						console.log(newChoices)
						if(pagePath === "2c" || pagePath === "2d" || pagePath === "4b") {
							this.choices.setChoiceByValue("2")
						}else {	
							this.choices.setChoiceByValue("1")
						}
					}
				});
			},

			listenVariantChange: function() {
				const self = this;
				
				if (hasFabricSelection) {
					let fabricSelectors = document.querySelectorAll('input[type=radio][name="fabric"]');
					fabricSelectors.forEach(function(selector) {
						selector.addEventListener('change', function() {
						self.fabric = this.value;

							self.updateVariant();
						})
					});
				}

				if (hasSizeSelection) {
					let sizeSelectors = document.querySelectorAll('input[type=radio][name="size"]');
					sizeSelectors.forEach(function(selector) {
						selector.addEventListener('change', function() {
							self.size = this.value;

							self.updateVariant('size');
							self.filterOutOfStockProducts('color');
							if (hasSelector) {
								self.updateQuantities();

								let choices = document.querySelectorAll('.choices__item--choice');
								choices.forEach(function(choice) {
									choice.classList.remove('is-highlighted');
									if (parseInt(choice.getAttribute('data-value')) === self.quantity ) {
										choice.classList.add('is-selected');
									}
								});
							}
						});
					});
				}

				if (hasColorSelection) {
					let colorSelectors = document.querySelectorAll('input[type=radio][name="color"]');
					colorSelectors.forEach(function(selector) {
						selector.addEventListener('change', function() {
							self.color = this.value;

							self.updateVariant('color');
							self.filterOutOfStockProducts('size');
							self.updateColorName();
							self.updateSliderImages('variant change hasColor');
						});
					});
				} 

				if(hasColorSelection && pagePath === "5b" ) {
					let colorSelectors = document.querySelectorAll('input[type=radio][name="color"]');
					colorSelectors.forEach(function(selector) {
						selector.addEventListener('change', function() {
							self.color = this.value;

							self.updateVariant('color');
							self.filterOutOfStockProducts('size');
							self.updateColorName();
							self.updateSliderImages('variant change 5b');
							self.updateQuantities()
						});
					});
				}
			},

			updateQuantities: function() {
				const self = this;
				let usPrefix = "";
				window.checkoutReadyCallbacks = window.checkoutReadyCallbacks || [];
				window.checkoutReadyCallbacks.push(() => {
					if (checkoutData.cart.shippingZone !== "US") {
						usPrefix = " USD"
					}
				});

				let items = [];
				Object.keys(variants).forEach(function(quantity, index) {
					let label = "";
						if(pagePath === "5b") {
							label = `${self.color} - ${self.size} - ${usPrefix} $${(variants[quantity][self.fabric][self.size][self.color]['sale_price']).toFixed(2)}* `;
						let selected = false;
						if (index === 0) {
							label = `${self.color} - King/Cali King - ${usPrefix} $${(variants[quantity][self.fabric][self.size][self.color]['sale_price']).toFixed(2)}* `;
						}
						if (index + 1 === parseInt(self.quantity)) {
							selected = true;
						}
						let variantData = {
							value: quantity,
							label: label,
							selected: selected
						}
						items.push(variantData);
					}else {
						label = `Add ${quantity} Sheets Sets for${usPrefix} $${(variants[quantity][self.fabric][self.size][self.color]['sale_price']  / quantity ).toFixed(2)}* each (${discounts[index]}  OFF)`;
						let selected = false;
						if (index === 0) {
							label = `Add ${quantity} Sheet Sets for${usPrefix} $${(variants[quantity][self.fabric][self.size][self.color]['sale_price']  / quantity ).toFixed(2)}* each (${discounts[index]}  OFF)`;
						}
						if (index + 1 === parseInt(self.quantity)) {
							selected = true;
						}
						let variantData = {
							value: quantity,
							label: label,
							selected: selected
						}
						items.push(variantData);
					}
					
				});

				self.choices.setChoices(items, 'value', 'label', true);
			},

			updateVariant: function(from) {
				const self = this;

				let variantInput = document.getElementById('upsell-param-1');

				if (hasFabricSelection) {
					self.fabric = document.querySelector('input[type=radio][name="fabric"]:checked').value;
				}
				if (hasSizeSelection) {
					self.size = document.querySelector('input[type=radio][name="size"]:checked').value;	
				}
				if (hasColorSelection) {
					self.color = document.querySelector('input[type=radio][name="color"]:checked').value;
				}
				let matchingVariant = variants[self.quantity][self.fabric][self.size][self.color];
				console.log(matchingVariant)

				if (matchingVariant === undefined || matchingVariant === null) {
					if (from === 'color') {
						let availableVariants = variants[self.quantity][self.fabric];
						let key;
						let firstAvailableVariant = Object.values(availableVariants).find(function(variant, index) {
							key = Object.keys(availableVariants)[index];
							if (variant[self.color]) {
								return variant[self.color].variantId.toString().length > 0;
							}
						});
						// let firstAvailableVariant = Object.keys(availableVariants)[0];
						let matchingSizeSelection = document.querySelector(`input[name="size"][value=${key}]`);
						console.log(matchingSizeSelection);
						matchingSizeSelection.click();

						return;
					} else if (from === 'size') {
						let availableVariants = variants[self.quantity][self.fabric][self.size];
						let firstAvailableVariant = Object.keys(availableVariants)[0];
						let matchingColorSelection = document.querySelector(`input[name="color"][value=${firstAvailableVariant}]`);
						matchingColorSelection.click();

						return;
					}
				} else {
					variantInput.value = matchingVariant['variantId'];
				}

				window.checkoutReadyCallbacks.push(() => {
					if (checkoutData.cart.shippingZone !== "US") {
						if (pagePath === '3b' || pagePath === '3b-v1') {
							document.querySelector('.price').innerHTML = `<span class="non-usa">USD</span> $${matchingVariant['price']}*`; 
						}
						$(".non-usa").html("USD ");
					} else{
						if (pagePath === '3b' || pagePath === '3b-v1') {
							document.querySelector('.price').innerHTML = `$${matchingVariant['price']}*`; 
						}
						$(".non-usa").html($(".non-usa").html());
					}
				});
			},

			updateSliderImages: function(from) {
				const self = this;

				console.log('Update slider images called from: ', from);

				self.swiper.destroy();
				self.thumbsSwiper.destroy();

				let images = document.querySelectorAll('.swiper-slide');
				let index = 1;

				images.forEach(function(image) {
					if (index > images.length / 2) {
						index = 1; }
					let imagePath = `./images/sliders/${pagePath}/${self.color}/0${index}.webp`;

					if(image.querySelector("img").classList.contains("thumb-img")) {
						imagePath = `./images/sliders/${pagePath}/${self.color}/0${index}_thumb.webp`;}

					image.querySelector("img").src = imagePath;
					if(pagePath !== "1b") {
						image.querySelector("img").setAttribute("data-src",imagePath);
					}
					
					index++;
				});

				self.initSwiper();
			},

			updateSize: function(event) {
				console.log( 'Called' );
				
			},

			updateColorName: function() {
				const self = this;
				
				let colorName = self.color;
				colorName = colorName.replace('_', ' ');
				document.getElementById('color-name').innerHTML = colorName.toUpperCase();
			},

			filterOutOfStockProducts: function(from) {
				const self = this;

				if (from === 'color') {
					let colors = document.querySelectorAll('input[name="color"]');
					colors.forEach(function(color) {
						let isMatching = variants[self.quantity][self.fabric][self.size][color.value];
						if (isMatching === undefined || isMatching === null) {
							color.parentNode.classList.add('out-of-stock');
						} else {
							color.parentNode.classList.remove('out-of-stock');
						}
					});
				}

				if (from === 'size') {
					let sizes = document.querySelectorAll('input[name="size"]');
					sizes.forEach(function(size) {
						let isMatching = variants[self.quantity][self.fabric][size.value][self.color];
						if (isMatching === undefined || isMatching === null) {
							size.parentNode.classList.add('out-of-stock');
						} else {
							size.parentNode.classList.remove('out-of-stock');
						}
					});
				}
			},

			toggleActiveClass: function() {
				if (hasToggleButtons) {
					let labels = document.querySelectorAll('label');

					labels.forEach(function(label) {
						label.addEventListener('click', function(e) {
							let currentSelection = label.parentNode.querySelector('.selected');
							currentSelection.classList.remove('selected');
							label.classList.add('selected');
						});
					});
				}
			},

			
			// Runs only on 1a and 1b
			swapVariantColors: function() {
				const self = this;
				console.log('Swap variants called');

				if (hasDynamicColorChange) {	
					console.log('Has dynamic color change');

					const stoneProducts = [
						"42636035260566",
						"42636035621014",
						"42636035784854",
						"42636035948694",
						"42636036309142",
						"42901454061718",
						"42901486633110",
						"42901492465814",
						"42901499871382",
						"42901522088086",
						"42558763073686",
						"42558763303062",
						"42558763532438",
						"42558763761814",
						"42558764384406",
						"42901602762902",
						"42901653618838",
						"42901671608470",
						"42901745303702",
						"42901803532438"
					];
				
					const skyBlueProducts = [
						"42636035326102",
						"42636035850390",
						"42636036014230",
						"42636036407446",
						"42901463466134",
						"42901496856726",
						"42901503377558",
						"42901523857558",	
						"42558763270294",
						"42558763499670",
						"42558763729046",
						"42558763958422",
						"42558764581014",
						"42901608661142",
						"42901673672854",
						"42901759033494",
						"42901805891734",
					];
					
					const whiteProducts = [
						"42636035391638",
						"42636035752086",
						"42636035915926",
						"42636036079766",
						"42901469921430",
						"42901489352854",
						"42901498298518",
						"42901507539094",
						"42558763237526",	
						"42558763466902",
						"42558763696278",
						"42558763925654",	
						"42901617967254",
						"42901664071830",
						"42901675049110",
						"42901768601750",
					];
				
					const navyBlueProducts = [
						"42636035293334",
						"42636035981462",
						"42901459140758",
						"42901501771926",	
						"42558763106454",	
						"42558763335830",
						"42558763565206",
						"42558763794582",
						"42558764417174",
						"42901605187734",
						"42901746876566",
					];
				
					const sandProducts = [
						"42636035358870",
						"42636036046998",
						"42901466185878",
						"42901505704086",	
						"42558763139222",
						"42558763368598",	
						"42558763597974",
						"42558763827350",
						"42558764449942",
						"42901613740182",
						"42901765619862",
					];
				
					const sageProducts = [
						"42636035489942",
						"42636036210838",
						"42901475459222",
						"42901516517526",
						"42558764843158",
						"42558765203606",
						"42558765236374",
						"42558764646550",
						"42558765039766",
						"42558765301910",
						"42558765367446",
						"42901630845078",
						"42901638742166",
						"42901781184662",
						"42901789507734",
						"42901791113366",
						"42901793144982",
					];
				
					const terracottaProducts = [
						"42636035588246",
						"42636036276374",
						"42901484241046",
						"42901517992086",	
						"42558764908694",
						"42558765170838",	
						"42558764712086",
						"42901644148886",
						"42901651128470",
						"42901794881686",
					];
				
					const charcoalProducts = [
						"42636035522710",
						"42636036145302",
						"42901481193622",
						"42901511536790",
						"42558764875926",
						"42558764679318",
						"42901640151190",
						"42901785477270"
					];

					const cart = Object.keys(RTC.getVariantQuantities());

					const hasStoneColor = stoneProducts.some(variant => cart.includes(variant));

					const hasSkyBlueColor = skyBlueProducts.some(variant => cart.includes(variant));

					const hasWhiteColor = whiteProducts.some(variant => cart.includes(variant));

					const hasNavyBlueColor = navyBlueProducts.some(variant => cart.includes(variant));

					const hasSandColor = sandProducts.some(variant => cart.includes(variant));

					const hasTerracottaColor = terracottaProducts.some(variant => cart.includes(variant));

					const hasCharcoalColor = charcoalProducts.some(variant => cart.includes(variant));

					const hasSageColor = sageProducts.some(variant => cart.includes(variant));

					if (hasStoneColor) { self.color = 'stone' };
					if (hasSkyBlueColor) { self.color = 'sky_blue' };
					if (hasWhiteColor) { self.color = 'white' };
					if (hasNavyBlueColor) { self.color = 'navy' };
					if (hasSandColor) { self.color = 'sand' };
					if (hasTerracottaColor) {self.color = "terracotta"};
					if (hasCharcoalColor) {self.color = "charcoal"};
					if (hasSageColor) {self.color = "sage"};

					self.updateSliderImages('swapVariants');

					console.log("inside function cart",cart);
					console.log("inside function color", self.color);
				}
			},

			findOutOfStock: function() {

			},

			initTimer: function() {
				const self = this;

				let timers = document.querySelectorAll('.timer');
				if (timers.length > 0) {
					timers.forEach(function(timer) {
						let duration = timer.getAttribute('data-timer-duration');

						self.startTimer(duration, timer);
					});
				}
			},

			startTimer: function(duration, element) {
				const timer = setInterval(function() {
					let minutes = Math.floor(duration / 60);
					let seconds = duration - (minutes * 60);
					if (minutes < 10) {
						minutes = `0${minutes}`;
					}
					if (seconds < 10) {
						seconds = `0${seconds}`;
					}

					element.innerHTML = `${minutes}:${seconds}`;

					if (duration < 1) {
						clearInterval(timer);
						return;
					} else {
						duration--;
					}
				}, 1000);
			},

			toggleConfirmationBanner: function() {
				let urlSearchParams = new URLSearchParams(window.location.search);
				let params = Object.fromEntries(urlSearchParams.entries());

				if (params['upsell'] === 'true' || params['upsell']) {
					document.querySelector('.confirmation-box').classList.remove('hidden');
				}

				if (params['first'] === 'true' || params['first']) {
					document.getElementById('first-upsell').classList.remove('hidden');
				}
			}
		}

		document.addEventListener('DOMContentLoaded', function(e) {
			console.log('Random log on DOM Ready');
			upsellHench.initSwiper();
			upsellHench.initVariantSelection();
			upsellHench.toggleActiveClass();
			upsellHench.listenVariantChange();
			upsellHench.initTimer();
			upsellHench.toggleConfirmationBanner();
		});

		window.checkoutReadyCallbacks.push(() => {
			console.log('RTC ready to swap colors');
			upsellHench.swapVariantColors();
		});
	</script>
	<script type="text/javascript">
	/*--------------------------------- Conversion Event Triggering ----------------------------------------------*/
	jQuery(".checkout-accept-upsell").click(function(e) {
		window.EF.conversion({
			aid: 2,
			amount: 40,
			adv_event_id: 7
		});
	});
	if (sessionStorage.getItem('from') && sessionStorage.getItem('from') === 'v25') {
		document.querySelector('.checkout-accept-upsell').setAttribute('data-next-url', 'https://try.miraclebrand.co/up/v5/2c-v1.html?upsell=true');
		document.querySelector('.decline-link').setAttribute('href', 'https://try.miraclebrand.co/up/v5/2c-v1.html');
	}
	</script>
	<script>
		TriplePixel('Contact', checkout.firedPixels[1].email);
	</script>
</body>
</html>